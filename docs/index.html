<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MegaSena Analyzer</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:12px}
button,input{padding:8px;margin:4px}
section{margin-top:16px}
</style>
</head>
<body>

<h1>MegaSena Analyzer</h1>

<input id="csvUrl" size="70" value="https://raw.githubusercontent.com/programadriano/mongodb-megasena/master/megasena.csv">
<button id="loadCsv">Carregar CSV</button>
<button id="analyze">Analisar</button>
<p id="status"></p>

<section>
<h3>Estat√≠sticas (10 anos)</h3>
<table border="1" id="topTable"></table>
</section>

<section>
<h3>Gerador</h3>
<button id="generate">Gerar jogo</button>
<pre id="games"></pre>
</section>

<script>
let draws=[];
let worker=new Worker('worker.js');

worker.onmessage=e=>{
 if(e.data.type==='stats'){
  const r=e.data.cls[3];
  topTable.innerHTML=`<tr><th>Quentes</th><th>Mornos</th><th>Frios</th></tr>
  <tr><td>${r.h.join(', ')}</td><td>${r.m.join(', ')}</td><td>${r.f.join(', ')}</td></tr>`;
 }
 if(e.data.type==='game'){
  games.textContent='Jogo: '+e.data.game.join(' - ');
 }
};

async function loadCSV(){
 status.textContent='Carregando CSV...';
 const t=await (await fetch(csvUrl.value)).text();
 draws=t.split(/\r?\n/).slice(1).map(l=>{
  const c=l.split(',');
  if(c.length<8)return null;
  return {d:new Date(c[1]),n:c.slice(2,8).map(Number)};
 }).filter(Boolean);
 status.textContent='CSV carregado: '+draws.length;
}

loadCsv.onclick=loadCSV;
analyze.onclick=()=>worker.postMessage({type:'analyze',draws});
generate.onclick=()=>worker.postMessage({type:'generate'});
</script>
</body>
</html>
